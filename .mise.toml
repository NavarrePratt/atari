[tools]
go = "1.25.4"

[tasks.build]
description = "Build the atari binary"
run = "go build -ldflags=\"-w -s -X main.version=$(git describe --tags --always --dirty 2>/dev/null || echo dev)\" -o atari ./cmd/atari"

[tasks.install]
description = "Install atari to ~/go/bin"
run = "GOBIN=$HOME/go/bin go install -ldflags=\"-w -s -X main.version=$(git describe --tags --always --dirty 2>/dev/null || echo dev)\" ./cmd/atari"

[tasks.test]
description = "Run all tests"
run = "go test -v ./..."

[tasks.lint]
description = "Run golangci-lint"
run = "golangci-lint run"

[tasks.fmt]
description = "Format Go code"
run = "go fmt ./..."

[tasks.clean]
description = "Remove build artifacts and runtime files"
run = ["rm -f atari", "rm -rf .atari/"]

[tasks.bake]
description = "Build container image via docker-bake.hcl"
run = "docker buildx bake"
